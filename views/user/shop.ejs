<%- include("../partials/users/header.ejs") %>

<div class="max-w-7xl mx-auto p-5">
    <section class="container mx-auto">
      <div class="flex justify-between items-center mb-5">
        <form action="/search" method="POST" class="flex items-center bg-gray-200 rounded-full overflow-hidden max-w-xs shadow-md">
          <input type="text" name="query" placeholder="Search items..." class="flex-1 p-2 text-sm bg-transparent outline-none" />
          <button type="submit" class="px-4 py-2 bg-teal-600 text-white rounded-full transition-transform transform hover:bg-blue-600 hover:scale-105">Search</button>
        </form>
      </div>
  
      <div class="flex gap-5">
        <!-- Sidebar -->
        <aside class="w-64 bg-gray-100 p-5 rounded-lg shadow-md">
          <div class="mb-5">
            <h3 class="font-bold text-gray-800 mb-3">Categories</h3>
            <ul class="text-gray-600 space-y-2">
                <% for(let i=0 ; i<category.length ; i++) {%>
                    <a href="/filter?category=<%= category[i]._id %>" class="hover:text-blue-500"><%= category[i].name %></a> <br>
             <% } %>
            </ul>
          </div>
          
          
          
            
          <div>
            <h3 class="font-bold text-gray-800 mb-3">Filter by Price</h3>
            <div class="space-y-3">
                <a href="/filterPrice?gt=0&lt=%3C500" class="block w-full py-2 bg-gray-200 rounded-full text-gray-700 text-center hover:bg-blue-500 hover:text-white transition">Under ₹500</a>
                <a href="/filterPrice?gt=500&lt=%3C1000" class="block w-full py-2 bg-gray-200 rounded-full text-gray-700 text-center hover:bg-blue-500 hover:text-white transition">₹500 - ₹1000</a>
                <a href="/filterPrice?gt=1000&lt=%3C1500" class="block w-full py-2 bg-gray-200 rounded-full text-gray-700 text-center hover:bg-blue-500 hover:text-white transition">₹1000 - ₹1500</a>
                <a href="/filterPrice?gt=1500&lt=%3C100000" class="block w-full py-2 bg-gray-200 rounded-full text-gray-700 text-center hover:bg-blue-500 hover:text-white transition">Above ₹1500</a>
                
            </div>
          </div>
        </aside>
        
        <!-- Product Grid -->
        <main class="flex-1 grid grid-cols-3 gap-5">
            <% for(let i = 0 ; i< products.length;i++){ %>
          <div class="border p-4 rounded-lg shadow-md relative text-center">
            <span class="absolute top-2 right-2 bg-gray-300 p-2 rounded-full cursor-pointer">❤️</span>
            <a href="/productDatails?id=<%=products[i]._id %>">
              <img src="<%= products[i].productImage[0] %>" alt="<%= products[i].productName %>" class="w-full h-auto rounded-md" />
              <h4 class="mt-3 font-semibold"><%= products[i].productName %></h4>
              <p class="text-gray-600"><%=products[i].description %></p>
              <p class="text-gray-800 font-bold">
                <strike class="text-gray-500">₹<%= products[i].regularPrice.toLocaleString('en-IN') %></strike>
                Price ₹:<%= products[i].salePrice.toLocaleString('en-IN') %>
              </p>
            </a>
            <button class="w-full mt-3 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 transition">Add to Cart</button>
          </div>
          <% } %>
        </main>
      </div>
  
      <!-- Pagination -->
      <div class="flex justify-center gap-3 mt-5">
          <% if (currentPage > 1) { %>
            <a href="/shop?page=<%= currentPage - 1 %>" class="px-4 py-2 bg-gray-200 rounded-full text-gray-700 hover:bg-blue-500 hover:text-white">1</a>
        <% } %>


        <% if (currentPage > 1) { %>
            <a href="/shop?page=<%= currentPage - 1 %>" class="px-4 py-2 bg-gray-200 rounded-full text-gray-700 hover:bg-blue-500 hover:text-white">Previous</a>
          <% } %>

          <% for (let i = 1; i <= totalPages; i++) { %>
            <a href="/shop?page=<%= i %>" 
               class="px-4 py-2 rounded-full text-gray-700 hover:bg-blue-500 hover:text-white 
                      <%= currentPage === i ? 'bg-blue-500 text-white' : 'bg-gray-200' %>">
              <%= i %>
            </a>
          <% } %>
          
      </div>
    </section>
  </div>
  
  <%- include('../partials/users/footer.ejs') %>